import{d as pe,a as be,m as ye,r as h,v as xe,c as w,o,e as c,f as t,q as m,t as i,g as s,j as p,F as M,k as I,h as L,i as _,l as v,A as he,s as _e,n as we,S as ke,w as fe,N as $e,E as Ce,b as Te,B as Me,V as Le}from"./app-4aaa95f7.js";const Se={class:"flex flex-col gap-3 bg-white rounded shadow"},je={class:"text-xl text-gray-800 font-bold sm:text-3xl dark:text-white flex items-center gap-2 py-2 px-5"},Ne={key:0,class:"bg-blue-50 text-blue-800 py-2 px-5 flex items-start gap-2"},Fe=["innerHTML"],Ae={key:1,class:"divide-y divide-gray-200 dark:divide-gray-700"},Ee={class:"h-10 w-10 rounded-full relative overflow-hidden"},He=["src","alt"],ze={class:"flex-1"},Be={class:"font-medium text-gray-800 flex justify-between"},Pe={class:"w-5 h-5 flex items-center justify-center bg-blue-600 text-white rounded-full"},Ve={key:0,class:"icon mgc_check_fill text-sm"},Ge={class:"text-gray-600 text-sm"},Re={class:"mt-1 text-base text-black"},Oe={class:"flex flex-col gap-2"},qe={key:0,class:"text-red-500 text-sm"},Ue=pe({__name:"comments",props:{advertisement:{}},setup(K){var a;const S=K,e=be(),U=ye(),f=h([]),b=h({current_page:1,last_page:1,per_page:10,total:0}),k=h(""),Y=h(((a=U.user)==null?void 0:a.name)??""),j=h(!1),$=h(!1),N=h({}),J=async()=>{if(S.advertisement.id){j.value=!0;try{const{data:r}=await _e.post(`/advertisements/${S.advertisement.id}/comments`,{name:Y.value,content:k.value});N.value={},r.ok&&(k.value="",f.value.unshift(r.comment)),ke({group:"dashboard",ok:r.ok,title:r.ok?fe("Success"):fe("Error"),text:r.message},2e3)}catch(r){r.response.status===422&&(N.value=r.response.data.errors)}finally{j.value=!1}}},u=async(r=1)=>{if(S.advertisement.id){$.value=!0;try{const{data:d}=await _e.get(`/advertisements/${S.advertisement.id}/comments?page=${r}`);d.ok&&(f.value=[...f.value,...d.comments.data],b.value={current_page:d.comments.current_page,last_page:d.comments.last_page,per_page:d.comments.per_page,total:d.comments.total})}catch(d){console.error(d)}finally{$.value=!1}}};return xe(async()=>await u()),(r,d)=>{var A,E,H;const y=w("router-link"),W=w("v-skeleton"),F=w("v-button"),D=w("v-textarea");return o(),c("section",Se,[t("h2",je,[d[2]||(d[2]=t("i",{class:"icon mgc_comment_2_line"},null,-1)),m(" "+i(r.$t("Post a comment")),1)]),(E=(A=s(e).appSettings)==null?void 0:A.warning_comments_message)!=null&&E.length?(o(),c("div",Ne,[d[3]||(d[3]=t("i",{class:"icon mgc_information_line text-3xl"},null,-1)),t("p",{innerHTML:(H=s(e).appSettings)==null?void 0:H.warning_comments_message},null,8,Fe)])):p("",!0),$.value?(o(),L(W,{key:2,class:"p-5","loop-number":10})):(o(),c("div",Ae,[(o(!0),c(M,null,I(f.value,l=>{var z,B,P,V,G,R,O;return o(),c("div",{class:we(["flex gap-3 py-2 px-5",r.advertisement.user.id===l.user.id?"bg-gray-100 dark:bg-gray-800":"bg-white dark:bg-gray-900"]),key:l.id},[t("figure",Ee,[v(y,{to:{name:(z=l==null?void 0:l.user)!=null&&z.is_business?"store.show":"profile_uid",params:{id:(B=l==null?void 0:l.user)==null?void 0:B.id,slug:(P=l==null?void 0:l.user)==null?void 0:P.slug}}},{default:_(()=>{var C,T;return[t("img",{class:"object-cover absolute inset-0 h-full w-full",src:((C=l.user)==null?void 0:C.avatar_url)??`https://ui-avatars.com/api/?name=${l.name}&color=333333&background=F4F4F4F4`,alt:((T=l.user)==null?void 0:T.name)??l.name},null,8,He)]}),_:2},1032,["to"])]),t("div",ze,[t("div",Be,[(V=l.user)!=null&&V.id?(o(),L(y,{key:0,to:{name:(G=l==null?void 0:l.user)!=null&&G.is_business?"store.show":"profile_uid",params:{id:(R=l==null?void 0:l.user)==null?void 0:R.id,slug:(O=l==null?void 0:l.user)==null?void 0:O.slug}},class:"flex items-center gap-2"},{default:_(()=>{var C,T;return[m(i((C=l.user)!=null&&C.id?l.user.name:l.name)+" ",1),t("span",Pe,[(T=l.user)!=null&&T.is_verified?(o(),c("i",Ve)):p("",!0)])]}),_:2},1032,["to"])):p("",!0)]),t("div",Ge,i(l.created_at),1),t("div",Re,i(l.content),1)])],2)}),128))])),b.value.last_page>1&&b.value.current_page<b.value.last_page?(o(),L(F,{key:3,onClick:d[0]||(d[0]=l=>u(b.value.current_page+1)),loading:$.value,disabled:$.value,type:"button",color:"gray",class:"w-fit place-self-end flex items-center gap-1 ltr:mr-2 rtl:ml-2"},{default:_(()=>[d[4]||(d[4]=t("i",{class:"icon mgc_down_fill text-xl"},null,-1)),m(" "+i(r.$t("Load more")),1)]),_:1},8,["loading","disabled"])):p("",!0),t("form",{class:"flex flex-col gap-5 py-2 px-5",onSubmit:he(J,["prevent"])},[t("div",Oe,[v(D,{"input-style":"two",label:r.$t("Comment"),id:r.$t("Comment"),placeholder:r.$t("Your comment"),"onUpdate:input":d[1]||(d[1]=l=>k.value=l),value:k.value},null,8,["label","id","placeholder","value"]),N.value.content?(o(),c("p",qe,i(N.value.content[0]),1)):p("",!0)]),v(F,{disabled:j.value,loading:j.value,type:"submit",color:"blue",class:"w-full"},{default:_(()=>[m(i(r.$t("Post")),1)]),_:1},8,["disabled","loading"])],32)])}}}),We={class:"container mx-auto py-10 flex flex-col gap-5"},De={key:0,class:"flex justify-end"},Ie={class:"flex flex-col-reverse md:flex-row gap-5 lg:gap-8"},Ye={class:"w-full md:w-[15.4rem] lg:w-[20rem] flex flex-col gap-5"},Je={key:0,class:"bg-white rounded shadow divide-y"},Ke={class:"text-xl font-semibold text-gray-700 p-4 flex items-center gap-1"},Qe={class:"p-5"},Xe={class:"flex flex-col gap-2"},Ze={class:"text-gray-700 dark:text-gray-200 font-semibold"},et={class:"text-gray-700 dark:text-gray-200"},tt={class:"bg-white rounded shadow divide-y overflow-hidden"},st={class:"text-xl font-semibold text-gray-700 p-4 flex items-center gap-1"},at={class:"p-5 text-center"},lt=["src"],ot={class:"py-2"},nt={key:0,class:"icon mgc_check_2_fill text-blue-600 dark:text-blue-400 text-lg"},it={class:"inline-flex text-gray-600 dark:text-gray-300 items-center font-bold text-[13.3px]",dir:"ltr"},rt={class:"flex flex-col divide-y divide-gray-200"},dt={class:"w-full"},ut={class:"flex-1 flex flex-col gap-10"},ct={key:0,class:"bg-white rounded shadow"},mt={class:"flex flex-col lg:flex-row justify-between items-start gap-2 lg:gap-5 p-4 border-b border-gray-200"},gt={class:"flex flex-col"},vt={class:"text-2xl font-semibold text-gray-800 dark:text-white"},_t={class:"flex flex-col lg:flex-row gap-2 lg:items-center"},ft={class:"text-gray-500 text-sm font-semibold flex items-center gap-1"},pt={class:"text-gray-500 text-sm font-semibold flex items-center gap-1"},yt={key:0},xt={class:"text-gray-500 text-sm font-semibold flex items-center gap-1"},bt={class:"flex items-center gap-2 text-base"},ht={key:0,class:"mx-1"},wt={key:1,class:"mx-1"},kt={class:"flex flex-col-reverse lg:flex-row gap-2 p-4"},$t={class:"flex flex-wrap lg:flex-col gap-2"},Ct=["onClick"],Tt=["src","alt"],Mt={class:"flex-1"},Lt=["src","alt"],St={class:"p-4"},jt=["innerHTML"],Nt={key:2},Ft={class:"flex flex-col gap-5"},At={class:"text-2xl font-semibold text-gray-800 dark:text-white"},Et={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 items-start gap-5"},Ht={key:0,class:"bg-black bg-opacity-60 fixed top-0 left-0 w-full h-full flex items-center justify-center z-[60]"},zt=["src"],Pt=pe({__name:"show",setup(K){const S={mapTypeControl:!0,styles:[{featureType:"all",elementType:"labels.text",stylers:[{color:"#878787"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f9f5ed"}]},{featureType:"road.highway",elementType:"all",stylers:[{color:"#f5f5f5"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"all",stylers:[{color:"#aee0f4"}]}]},e=$e(),U=ye(),f=Ce(),b=h(null),k=h(!1);h(void 0);const Y=u=>{window.open(`https://wa.me/${u}`,"_blank")},j=u=>{window.open(`tel:${u}`,"_blank")},$=async()=>{var u,a,r,d;try{const y=parseInt(f.currentRoute.value.params.id);if(!y||isNaN(y)){f.push({name:"404"});return}if(!await e.fetchOne(y)){f.push({name:"404"});return}b.value=e.advertisement.main_media,await e.saveToLocalStorage(y),e.filters={},(u=e.advertisement.city)!=null&&u.id&&(e.filters.city_id=e.advertisement.city.id),(a=e.advertisement.country)!=null&&a.id&&(e.filters.country_id=e.advertisement.country.id),(r=e.advertisement.category)!=null&&r.id&&(e.filters.category=e.advertisement.category.id),(d=e.advertisement.sub_category)!=null&&d.id&&(e.filters.sub_category=e.advertisement.sub_category.id),e.filters.except=e.advertisement.id,await Me(async()=>{await e.fetch()})}catch(y){console.error("Error fetching advertisement:",y),f.push({name:"404"})}},N=()=>{k.value=!0};Te(()=>f.currentRoute.value.params.id,async u=>{if(!u||isNaN(parseInt(u))){f.push({name:"404"});return}await $()}),xe(async()=>await $());function J(u){const a=document.createElement("div");return a.innerHTML=u,a.textContent||a.innerText||""}return e.advertisement.description&&(e.advertisement.description=J(e.advertisement.description)),(u,a)=>{var D,A,E,H,l,z,B,P,V,G,R,O,C,T,Q,X,Z,ee,te,se,ae,le,oe,ne,ie,re,de,ue,ce,me,ge,ve;const r=w("v-button"),d=w("router-link"),y=w("GMapMarker"),W=w("GMapMap"),F=w("v-skeleton");return o(),c(M,null,[t("div",We,[s(e).isLoading?p("",!0):(o(),c("div",De,[v(r,{color:(D=s(e).advertisement)!=null&&D.is_favorite?"coralred":"gray",loading:s(e).toggleFavoriteLoading,onClick:a[0]||(a[0]=n=>s(e).toggleFavorite(s(e).advertisement,!1,!0))},{default:_(()=>{var n;return[a[6]||(a[6]=t("i",{class:"icon mgc_heart_fill"},null,-1)),m(" "+i((n=s(e).advertisement)!=null&&n.is_favorite?u.$t("Remove from favorites"):u.$t("Add to favorites")),1)]}),_:1},8,["color","loading"])])),t("div",Ie,[t("aside",Ye,[s(e).isLoading?(o(),L(F,{key:1,"loop-number":29})):(o(),c(M,{key:0},[(A=s(e).advertisement.filters)!=null&&A.length?(o(),c("section",Je,[t("header",Ke,[a[7]||(a[7]=t("i",{class:"icon mgc_more_2_fill"},null,-1)),m(" "+i(u.$t("More information")),1)]),t("div",Qe,[t("div",Xe,[(o(!0),c(M,null,I(s(e).advertisement.filters,n=>(o(),c("div",{key:n.name.toLowerCase(),class:"flex justify-between text-sm"},[t("div",Ze,i(n.name)+" : ",1),t("div",et,i(n.value),1)]))),128))])])])):p("",!0),t("section",tt,[t("header",st,[a[8]||(a[8]=t("i",{class:"icon mgc_user_star_fill"},null,-1)),m(" "+i(u.$t("Contact owner")),1)]),t("div",at,[t("img",{class:"h-32 w-32 rounded-full border-4 border-white dark:border-gray-800 mx-auto",src:(H=(E=s(e).advertisement)==null?void 0:E.user)==null?void 0:H.avatar_url,alt:""},null,8,lt),t("div",ot,[v(d,{class:"block font-bold text-2xl text-gray-800 hover:text-blue-700 mb-1",to:{name:(z=(l=s(e).advertisement)==null?void 0:l.user)!=null&&z.is_business?"store.show":"profile_uid",params:{id:(P=(B=s(e).advertisement)==null?void 0:B.user)==null?void 0:P.id,slug:(G=(V=s(e).advertisement)==null?void 0:V.user)==null?void 0:G.slug}}},{default:_(()=>{var n,g,x,q;return[m(i((g=(n=s(e).advertisement)==null?void 0:n.user)==null?void 0:g.name)+" ",1),(q=(x=s(e).advertisement)==null?void 0:x.user)!=null&&q.is_verified?(o(),c("i",nt)):p("",!0)]}),_:1},8,["to"]),t("div",it," ("+i((O=(R=s(e).advertisement)==null?void 0:R.user)==null?void 0:O.country_code)+") "+i((T=(C=s(e).advertisement)==null?void 0:C.user)==null?void 0:T.phone_number),1)])]),t("div",rt,[s(U).me&&s(U).me.id!==((X=(Q=s(e).advertisement)==null?void 0:Q.user)==null?void 0:X.id)?(o(),c(M,{key:0},[v(r,{color:"gray",rounded:"none","custom-class":"flex items-start justify-start py-3",onClick:a[1]||(a[1]=n=>{var g,x;return Y(`${(g=s(e).advertisement)==null?void 0:g.user.country_code}${(x=s(e).advertisement)==null?void 0:x.user.phone_number}`)})},{default:_(()=>[a[9]||(a[9]=t("i",{class:"icon mgc_whatsapp_fill"},null,-1)),m(" "+i(u.$t("WhatsApp")),1)]),_:1}),v(r,{color:"gray",rounded:"none","custom-class":"flex items-start justify-start py-3",onClick:a[2]||(a[2]=n=>{var g,x;return j(`${(g=s(e).advertisement)==null?void 0:g.user.country_code}${(x=s(e).advertisement)==null?void 0:x.user.phone_number}`)})},{default:_(()=>[a[10]||(a[10]=t("i",{class:"icon mgc_phone_call_fill"},null,-1)),m(" "+i(u.$t("Call")),1)]),_:1}),v(r,{color:"gray",rounded:"none","custom-class":"flex items-start justify-start py-3",onClick:a[3]||(a[3]=n=>{var g,x,q;return s(f).push({name:"chat",query:{advertisement_id:(g=s(e).advertisement)==null?void 0:g.id,user_id:(q=(x=s(e).advertisement)==null?void 0:x.user)==null?void 0:q.id}})})},{default:_(()=>[a[11]||(a[11]=t("i",{class:"icon mgc_chat_1_fill"},null,-1)),m(" "+i(u.$t("Chat")),1)]),_:1})],64)):(o(),L(r,{key:1,color:"green",rounded:"none","custom-class":"flex items-start justify-start py-3",onClick:a[4]||(a[4]=n=>{var g;return s(f).push({name:"edit-advertisement",params:{id:(g=s(e).advertisement)==null?void 0:g.id}})})},{default:_(()=>[a[12]||(a[12]=t("i",{class:"icon mgc_edit_fill"},null,-1)),m(" "+i(u.$t("Edit")),1)]),_:1}))])]),t("section",dt,[v(W,{center:{lat:((Z=s(e).advertisement)==null?void 0:Z.latitude)||15.5527,lng:((ee=s(e).advertisement)==null?void 0:ee.longitude)||48.5164},zoom:15,options:S,class:"w-full h-[500px]"},{default:_(()=>{var n,g;return[v(y,{position:{lat:((n=s(e).advertisement)==null?void 0:n.latitude)||15.5527,lng:((g=s(e).advertisement)==null?void 0:g.longitude)||48.5164},clickable:!1,draggable:!1},null,8,["position"])]}),_:1},8,["center"])])],64))]),t("main",ut,[s(e).isLoading?(o(),L(F,{key:1,"loop-number":29})):(o(),c("section",ct,[t("header",mt,[t("div",gt,[t("h1",vt,i(s(e).advertisement.name),1),t("div",_t,[t("time",ft,[a[13]||(a[13]=t("i",{class:"icon mgc_calendar_time_add_line text-xl"},null,-1)),m(" "+i(s(e).advertisement.created_at),1)]),t("span",pt,[a[14]||(a[14]=t("i",{class:"icon mgc_location_line text-xl"},null,-1)),m(" "+i((te=s(e).advertisement.country)==null?void 0:te.name)+" ",1),(se=s(e).advertisement.city)!=null&&se.id?(o(),c("span",yt,"/ "+i(s(e).advertisement.city.name),1)):p("",!0)]),t("span",xt,[a[15]||(a[15]=t("i",{class:"icon mgc_eye_line text-xl"},null,-1)),m(" "+i(u.$t("This advertisement has been viewed :count times",{count:((le=(ae=s(e).advertisement)==null?void 0:ae.views)==null?void 0:le.toString())||"0"})),1)])])]),t("span",bt,[a[18]||(a[18]=t("i",{class:"icon mgc_sitemap_line text-xl"},null,-1)),v(d,{to:{name:"customer.category.show",params:{slug:(oe=s(e).advertisement.category)==null?void 0:oe.slug}}},{default:_(()=>{var n;return[m(i((n=s(e).advertisement.category)==null?void 0:n.name),1)]}),_:1},8,["to"]),(ne=s(e).advertisement.sub_category)!=null&&ne.id?(o(),c("span",ht,[a[16]||(a[16]=m(" / ",-1)),v(d,{to:{name:"customer.category.show",params:{slug:(ie=s(e).advertisement.category)==null?void 0:ie.slug,sub:(re=s(e).advertisement.sub_category)==null?void 0:re.id}}},{default:_(()=>[m(i(s(e).advertisement.sub_category.name),1)]),_:1},8,["to"])])):p("",!0),(de=s(e).advertisement.sub_sub_category)!=null&&de.id?(o(),c("span",wt,[a[17]||(a[17]=m(" / ",-1)),v(d,{to:{name:"customer.category.show",params:{slug:(ue=s(e).advertisement.category)==null?void 0:ue.slug,sub:(ce=s(e).advertisement.sub_category)==null?void 0:ce.id,subsub:(me=s(e).advertisement.sub_sub_category)==null?void 0:me.id}}},{default:_(()=>[m(i(s(e).advertisement.sub_sub_category.name),1)]),_:1},8,["to"])])):p("",!0)])]),t("div",kt,[t("div",$t,[(o(!0),c(M,null,I(s(e).advertisement.media,n=>(o(),c("button",{key:n.url_thumb,onClick:g=>b.value=n,class:"h-20 w-20 overflow-hidden rounded-lg text-center"},[t("img",{class:"h-full w-full object-cover",src:n.url,alt:s(e).advertisement.name,loading:"lazy"},null,8,Tt)],8,Ct))),128))]),t("div",Mt,[t("img",{class:"max-h-[38rem] w-full object-cover rounded-lg",src:(ge=b.value)==null?void 0:ge.url,alt:s(e).advertisement.name,loading:"lazy",onClick:N},null,8,Lt)])]),a[19]||(a[19]=t("hr",null,null,-1)),t("div",St,[t("div",{class:"text-gray-700 dark:text-gray-200 my-2",innerHTML:s(e).advertisement.description},null,8,jt)])])),v(Ue,{advertisement:s(e).advertisement},null,8,["advertisement"]),!s(e).isLoading&&s(e).advertisements.length?(o(),c("div",Nt,[t("div",Ft,[t("h2",At,[a[20]||(a[20]=t("i",{class:"icon mgc_multiselect_fill"},null,-1)),m(" "+i(u.$t("Similar advertisements")),1)]),t("div",Et,[(o(!0),c(M,null,I(s(e).advertisements,n=>(o(),L(Le,{key:n.id,advertisement:n},null,8,["advertisement"]))),128))])])])):p("",!0)])])]),k.value?(o(),c("div",Ht,[t("img",{alt:"",class:"rounded-lg max-h-[90%] max-w-[90%]",src:(ve=b.value)==null?void 0:ve.url},null,8,zt),t("button",{onClick:a[5]||(a[5]=n=>k.value=!1),class:"absolute top-5 right-5 w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-lg"},[...a[21]||(a[21]=[t("i",{class:"icon mgc_close_fill text-lg"},null,-1)])])])):p("",!0)],64)}}});export{Pt as default};
